<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TheTycoon - Fire0x Tools</title>
    <!-- Title and favicon will be set by site-config.js -->
    <!-- Bootstrap CSS -->
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <!-- Custom CSS -->
    <link href="css/styles.css" rel="stylesheet">
    <!-- Base CSS (load order matters) -->
    <link href="css/base/variables.css" rel="stylesheet">
    <link href="css/base/common.css" rel="stylesheet">
    <link href="css/base/responsive.css" rel="stylesheet">
    <!-- Page-specific CSS -->
    <link href="css/pages/apartment.css" rel="stylesheet">
</head>
<body>
    <!-- Navbar is injected by js/navbar.js -->

    <!-- Page Header -->
    <section class="hero">
        <div class="container">
            <h1 class="glow-text">üè† Apartment Management</h1>
            <p class="lead">Manage your apartments, rental due dates, and cleaning schedules</p>
        </div>
    </section>

    <!-- Main Content -->
    <main class="container py-5">

        <!-- How to Use Section -->
        <div class="row mb-4">
            <div class="col-md-12">
                <div class="card mb-4">
                    <div class="card-header" style="background-color: var(--card-bg); border-bottom: 1px solid var(--card-border);">
                        <button class="btn btn-link text-decoration-none w-100 text-start p-0" type="button" data-bs-toggle="collapse" data-bs-target="#howToUseCollapse" aria-expanded="true" aria-controls="howToUseCollapse" style="color: var(--text-color); font-weight: 600;">
                            <span>üìñ How to Use This Page</span>
                            <span class="float-end" id="howToUseToggle">‚ñº</span>
                        </button>
                    </div>
                    <div class="collapse show" id="howToUseCollapse">
                        <div class="card-body">
                            <div class="mb-3">
                                <h6 class="mb-2"><strong>Step 1: Add an Apartment</strong></h6>
                                <p class="mb-2">Select <strong>"‚ûï Create New Apartment"</strong> from the dropdown menu, or click <span class="badge bg-primary">‚ûï Create New Apartment</span> in the selector. Fill in the required fields:</p>
                                <ul class="mb-3">
                                    <li><strong>Location:</strong> The area where the apartment is located (e.g., "Del Perrro")</li>
                                    <li><strong>Apartment Name:</strong> A descriptive name (e.g., "Ocean Breeze Suite #1")</li>
                                    <li><strong>Apartment No.:</strong> The apartment number</li>
                                    <li><strong>Owned Number:</strong> Leave empty to auto-assign, or enter a sequential number</li>
                                    <li><strong>Postal:</strong> <em>Optional</em> - Postal code</li>
                                    <li><strong>Class:</strong> <em>Optional</em> - Apartment class (e.g., Luxury, Standard)</li>
                                    <li><strong>Description:</strong> <em>Optional</em> - Additional notes about the apartment</li>
                                    <li><strong>Prices:</strong> <em>Optional</em> - Purchased price and renting out price</li>
                                </ul>
                                
                                <h6 class="mb-2"><strong>Step 2: Set Rental Due Dates</strong></h6>
                                <p class="mb-2">Set when rent is due using the <strong>Due Date (Rent)</strong> field:</p>
                                <ul class="mb-3">
                                    <li>Click <span class="badge bg-success">Rent Out</span> to set it to current Brisbane time + 7 days</li>
                                    <li>Click <span class="badge bg-info">+7 Days</span> to add 7 days to a manually entered date</li>
                                    <li>Or manually enter a date and time</li>
                                    <li>The date will be displayed in Local and Eastern time zones</li>
                                </ul>
                                
                                <h6 class="mb-2"><strong>Step 3: Set Cleaning Times</strong></h6>
                                <p class="mb-2">Set when cleaning is due using the <strong>Clean Time</strong> field:</p>
                                <ul class="mb-3">
                                    <li>Click <span class="badge bg-success">Clean Now +4h</span> to set it to current local time + 4 hours</li>
                                    <li>Or manually enter a date and time</li>
                                    <li><strong>Note:</strong> Cleaning time and due date cannot be the same time</li>
                                </ul>
                                
                                <h6 class="mb-2"><strong>Step 4: Manage Apartments</strong></h6>
                                <p class="mb-2">Once apartments are added, you can:</p>
                                <ul class="mb-3">
                                    <li><strong>View All Apartments:</strong> See all apartments in card format with tabs for Info and Reviews</li>
                                    <li><strong>Edit Apartments:</strong> Click <span class="badge bg-primary">Edit</span> to modify apartment details</li>
                                    <li><strong>Add Reviews:</strong> Click <span class="badge bg-info">Reviews</span> to add and manage reviews with ratings (0.5-5 stars)</li>
                                    <li><strong>Edit Rent Price:</strong> Click the ‚úèÔ∏è icon next to the rent price in the table to quickly edit it</li>
                                    <li><strong>Hide/Show Apartments:</strong> Use checkboxes in the "All Apartments" section to toggle visibility</li>
                                    <li><strong>Lock Apartments:</strong> Use <span class="badge bg-secondary">üîí Lock All</span> to prevent accidental edits</li>
                                </ul>
                                
                                <h6 class="mb-2"><strong>Step 5: Export/Import Data</strong></h6>
                                <p class="mb-2">Backup and restore your apartment data:</p>
                                <ul class="mb-3">
                                    <li><strong>Export Apartments:</strong> Click <span class="badge bg-success">üì§ Export Apartments</span> to backup apartment data</li>
                                    <li><strong>Export Timers:</strong> Click <span class="badge bg-info">‚è±Ô∏è Export Timers</span> to backup due dates and clean times</li>
                                    <li><strong>Export Reviews:</strong> Click <span class="badge bg-primary">‚≠ê Export Reviews</span> to backup all reviews</li>
                                    <li><strong>Export All Data:</strong> Click <span class="badge bg-success">üì¶ Export All Data</span> to backup everything at once</li>
                                    <li><strong>Import:</strong> Use the corresponding import buttons to restore your data</li>
                                    <li>Copy the JSON text using <kbd>Ctrl</kbd> + <kbd>A</kbd> then <kbd>Ctrl</kbd> + <kbd>C</kbd> (or <kbd>Cmd</kbd> + <kbd>A</kbd> / <kbd>Cmd</kbd> + <kbd>C</kbd> on Mac)</li>
                                </ul>
                                
                                <h6 class="mb-2"><strong>Step 6: View Statistics</strong></h6>
                                <p class="mb-2">Check the <strong>Overview</strong> tab to see:</p>
                                <ul class="mb-3">
                                    <li>Total number of apartments</li>
                                    <li>Overall rating across all apartments</li>
                                    <li>Total number of reviews</li>
                                </ul>
                                
                                <p class="mb-0"><strong>üí° Tip:</strong> All data is automatically saved to your browser's localStorage. The page will show alerts for apartments with rent due soon or cleaning overdue. Use the <span class="badge bg-secondary">üêõ Debug</span> button to enable debug logging in the browser console.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Actions Needed Alert -->
        <div id="actionsNeededAlert" class="alert alert-warning alert-dismissible fade show" role="alert" style="display: none; margin-bottom: 1.5rem;">
            <h5 class="alert-heading mb-3">‚ö†Ô∏è Actions Needed</h5>
            <div id="actionsNeededContent">
                <!-- Actions will be populated here -->
            </div>
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
        </div>

        <!-- Time Displays -->
        <div class="row mb-4">
            <div class="col-md-12">
                <div class="card">
                    <div class="card-body">
                        <div class="row text-center">
                            <div class="col-md-4 mb-3 mb-md-0">
                                <div class="time-display">
                                    <strong>üïê Local Time:</strong> 
                                    <div id="local-time" class="text-info" style="font-size: 1.2rem; margin-top: 0.5rem;">--:--:--</div>
                                </div>
                            </div>
                            <div class="col-md-4 mb-3 mb-md-0">
                                <div class="time-display">
                                    <strong>üïê Eastern Time:</strong> 
                                    <div id="eastern-time" class="text-info" style="font-size: 1.2rem; margin-top: 0.5rem;">--:--:--</div>
                                    <span id="eastern-tz" class="text-muted small">EST</span>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="time-display">
                                    <strong>üìÖ Current Date:</strong> 
                                    <div id="current-date" class="text-info" style="font-size: 1.2rem; margin-top: 0.5rem;">--/--/----</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Apartments Summary -->
        <div class="card mb-4">
            <div class="card-body">
                <div class="row text-center">
                    <div class="col-md-12">
                        <h3 class="mb-0">
                            <span class="text-info">üè¢ Apartments Owned by Fire0x Incorporated:</span>
                            <span id="apartmentCount" class="text-info" style="font-size: 2rem; font-weight: 700; margin-left: 0.5rem;">0</span>
                            <span class="ms-3" style="font-size: 1.5rem;">
                                <span id="overallRating" class="text-warning">‚≠ê --</span>
                                <small class="text-muted ms-1" id="overallRatingText">(Overall Rating)</small>
                            </span>
                        </h3>
                    </div>
                </div>
            </div>
        </div>

        <!-- Apartment Selector -->
        <div class="card mb-4">
            <div class="card-header bg-primary text-white">
                <h3 class="mb-0">Select Apartment</h3>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-6">
                        <label for="apartmentSelector" class="form-label">Apartment</label>
                        <select class="form-select" id="apartmentSelector" onchange="loadApartmentData()">
                            <option value="">-- Select or Create Apartment --</option>
                            <option value="new">‚ûï Create New Apartment</option>
                        </select>
                    </div>
                    <div class="col-md-6 d-flex align-items-end gap-2">
                        <button type="button" class="btn btn-success" id="saveApartmentBtn" onclick="saveApartmentFromSelector()" style="display: none;">
                            üíæ Save Apartment
                        </button>
                        <button type="button" class="btn btn-light btn-sm" id="debugToggleBtn" onclick="toggleDebugMode()" title="Toggle debug logging to console">
                            üêõ Debug: OFF
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Export/Import Section -->
        <div class="card mb-4">
            <div class="card-header bg-info text-white">
                <h3 class="mb-0">Export/Import</h3>
            </div>
            <div class="card-body">
                <div class="d-flex flex-wrap gap-2 mb-3">
                    <button type="button" class="btn btn-success" onclick="exportApartments()">üì§ Export Apartments</button>
                    <button type="button" class="btn btn-warning" onclick="openImportModal()">üì• Import Apartments</button>
                    <button type="button" class="btn btn-info" onclick="exportTimers()">‚è±Ô∏è Export Timers</button>
                    <button type="button" class="btn btn-secondary" onclick="openImportTimersModal()">‚è±Ô∏è Import Timers</button>
                    <button type="button" class="btn btn-primary" onclick="exportReviews()">‚≠ê Export Reviews</button>
                    <button type="button" class="btn btn-danger" onclick="openImportReviewsModal()">‚≠ê Import Reviews</button>
                </div>
                <hr>
                <div class="d-flex flex-wrap gap-2">
                    <button type="button" class="btn btn-success btn-lg" onclick="exportAll()">üì¶ Export All Data</button>
                    <button type="button" class="btn btn-warning btn-lg" onclick="openImportAllModal()">üì¶ Import All Data</button>
                </div>
            </div>
        </div>

        <!-- Tab Navigation -->
        <ul class="nav nav-tabs mb-4" id="apartmentTabs" role="tablist">
            <li class="nav-item" role="presentation">
                <button class="nav-link active" id="apartments-tab" data-bs-toggle="tab" data-bs-target="#apartments" type="button" role="tab">
                    Apartments
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="reviews-tab" data-bs-toggle="tab" data-bs-target="#reviews" type="button" role="tab">
                    Reviews
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="overview-tab" data-bs-toggle="tab" data-bs-target="#overview" type="button" role="tab">
                    Overview
                </button>
            </li>
        </ul>

        <!-- Tab Content -->
        <div class="tab-content" id="apartmentTabsContent">
            <!-- Apartments Tab -->
            <div class="tab-pane fade show active" id="apartments" role="tabpanel">
                <div class="card section-card">
                    <div class="card-header bg-primary text-white">
                        <div class="d-flex justify-content-between align-items-center">
                            <h3 class="mb-0">Apartments</h3>
                            <button type="button" class="btn btn-light btn-sm" id="toggleTableBtn" onclick="toggleApartmentsTable()" title="Toggle table visibility">
                                üôà Hide Table
                            </button>
                        </div>
                    </div>
                    <div class="card-body">
                        <div id="loadingAlert" class="alert alert-secondary" role="alert">
                            <span class="spinner-border spinner-border-sm me-2" role="status" aria-hidden="true"></span>
                            Loading apartments...
                        </div>
                        <div id="apartmentsTableContainer" style="display: none;">
                            <div class="table-responsive">
                                <table class="table table-striped table-hover">
                                    <thead>
                                        <tr>
                                            <th>Owned #</th>
                                            <th>Location</th>
                                            <th>Apartment Name</th>
                                            <th>Apartment No.</th>
                                            <th>Postal</th>
                                            <th>Class</th>
                                            <th>Purchased Price</th>
                                            <th>Renting Price</th>
                                            <th>Due Date</th>
                                            <th>Clean Time</th>
                                            <th>Rating</th>
                                            <th>Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody id="apartmentsTableBody">
                                        <!-- Apartments will be dynamically inserted here -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                        <div id="noApartmentsAlert" class="alert alert-info" role="alert" style="display: none;">
                            No apartments found. Click "Add Apartment" to get started.
                        </div>
                    </div>
                </div>

                <!-- All Apartments Section (like All Businesses by Tier) -->
                <div class="card mt-4">
                    <div class="card-header bg-secondary text-white">
                        <div class="d-flex justify-content-between align-items-center">
                            <h3 class="mb-0">All Apartments</h3>
                            <div class="d-flex gap-2">
                                <button class="btn btn-sm btn-light" onclick="showAllApartments()" title="Show All Apartments">
                                    üëÅÔ∏è Show All
                                </button>
                                <button class="btn btn-sm btn-light" onclick="hideAllApartments()" title="Hide All Apartments">
                                    üôà Hide All
                                </button>
                                <button class="btn btn-sm btn-light" onclick="lockAllApartments()" title="Lock All Apartments">
                                    üîí Lock All
                                </button>
                                <button class="btn btn-sm btn-light" onclick="unlockAllApartments()" title="Unlock All Apartments">
                                    üîì Unlock All
                                </button>
                            </div>
                        </div>
                    </div>
                    <div class="card-body">
                        <!-- Filter Controls -->
                        <div class="row mb-3">
                            <div class="col-md-12">
                                <label class="form-label me-2">Show Apartments:</label>
                                <div id="apartmentVisibilityControls" class="d-flex flex-wrap gap-2">
                                    <!-- Apartment checkboxes will be populated here -->
                                </div>
                            </div>
                        </div>
                        <div id="allApartmentsContainer">
                            <p class="text-muted text-center">Loading apartments...</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Reviews Tab -->
            <div class="tab-pane fade" id="reviews" role="tabpanel">
                <div class="card section-card">
                    <div class="card-header bg-success text-white">
                        <h3 class="mb-0">All Reviews</h3>
                    </div>
                    <div class="card-body">
                        <div id="allReviewsContainer">
                            <p class="text-muted text-center">Loading reviews...</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Overview Tab -->
            <div class="tab-pane fade" id="overview" role="tabpanel">
                <div class="card section-card">
                    <div class="card-header bg-info text-white">
                        <h3 class="mb-0">Overview & Statistics</h3>
                    </div>
                    <div class="card-body">
                        <div id="overviewContainer">
                            <div class="row g-4">
                                <div class="col-md-4">
                                    <div class="card h-100 shadow-sm border-0" style="background: var(--primary-gradient);">
                                        <div class="card-body text-white text-center">
                                            <div class="mb-3" style="font-size: 3rem;">üè†</div>
                                            <h5 class="card-title mb-2" style="opacity: 0.95;">Total Apartments</h5>
                                            <p class="card-text mb-0" style="font-size: 3rem; font-weight: 700;" id="overviewTotalApartments">0</p>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="card h-100 shadow-sm border-0" style="background: var(--warning-gradient);">
                                        <div class="card-body text-white text-center">
                                            <div class="mb-3" style="font-size: 3rem;">‚≠ê</div>
                                            <h5 class="card-title mb-2" style="opacity: 0.95;">Overall Rating</h5>
                                            <p class="card-text mb-0" style="font-size: 2.5rem; font-weight: 700;" id="overviewOverallRating">--</p>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="card h-100 shadow-sm border-0" style="background: var(--info-gradient);">
                                        <div class="card-body text-white text-center">
                                            <div class="mb-3" style="font-size: 3rem;">üìù</div>
                                            <h5 class="card-title mb-2" style="opacity: 0.95;">Total Reviews</h5>
                                            <p class="card-text mb-0" style="font-size: 3rem; font-weight: 700;" id="overviewTotalReviews">0</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Add/Edit Apartment Modal -->
    <div class="modal fade" id="apartmentModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="apartmentModalTitle">Add Apartment</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="apartmentForm">
                        <input type="hidden" id="apartmentId">
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="location" class="form-label">Location <span class="text-danger">*</span></label>
                                <input type="text" class="form-control" id="location" required>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="apartmentName" class="form-label">Apartment Name <span class="text-danger">*</span></label>
                                <input type="text" class="form-control" id="apartmentName" required>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="apartmentNo" class="form-label">Apartment No. <span class="text-danger">*</span></label>
                                <input type="text" class="form-control" id="apartmentNo" required>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="ownedNumber" class="form-label">Owned Number</label>
                                <input type="number" class="form-control" id="ownedNumber" placeholder="Auto-assigned if empty">
                                <small class="form-text text-muted">Sequential number for apartments owned by Fire0x Incorporated</small>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="postal" class="form-label">Postal</label>
                                <input type="text" class="form-control" id="postal">
                            </div>
                        </div>
                        <div class="mb-3">
                            <label for="apartmentClass" class="form-label">Class</label>
                            <input type="text" class="form-control" id="apartmentClass" placeholder="e.g., Luxury, Standard, Economy">
                        </div>
                        <div class="mb-3">
                            <label for="apartmentDescription" class="form-label">Apartment Description</label>
                            <textarea class="form-control" id="apartmentDescription" rows="3"></textarea>
                        </div>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="purchasedPrice" class="form-label">Purchased Price</label>
                                <input type="text" class="form-control money-input" id="purchasedPrice" placeholder="0">
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="rentingOutPrice" class="form-label">Renting out Price</label>
                                <input type="text" class="form-control money-input" id="rentingOutPrice" placeholder="0">
                            </div>
                        </div>
                        <div class="mb-3">
                            <label for="dueDate" class="form-label">Due Date (Rent)</label>
                            <div class="input-group">
                                <input type="datetime-local" class="form-control" id="dueDate">
                                <button type="button" class="btn btn-success" onclick="setRentOutNow()">Rent Out</button>
                                <button type="button" class="btn btn-info" onclick="addSevenDays()">+7 Days</button>
                            </div>
                            <small class="form-text text-muted timezone-display">
                                Local: <span id="dueDateLocal">--</span> | 
                                Eastern: <span id="dueDateEastern">--</span>
                            </small>
                        </div>
                        <div class="mb-3">
                            <label for="cleanTime" class="form-label">Clean Time</label>
                            <div class="input-group">
                                <input type="datetime-local" class="form-control" id="cleanTime">
                                <button type="button" class="btn btn-success" onclick="setCleanNow()">Clean Now +4h</button>
                            </div>
                            <small class="form-text text-muted timezone-display">
                                Local: <span id="cleanTimeLocal">--</span> | 
                                Brisbane: <span id="cleanTimeBrisbane">--</span> | 
                                Eastern: <span id="cleanTimeEastern" class="eastern-date">--</span>
                            </small>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary" onclick="saveApartment()">Save Apartment</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Reviews Modal -->
    <div class="modal fade" id="reviewsModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="reviewsModalTitle">Apartment Reviews</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div id="ratingOverviewContainer">
                        <div class="text-center">
                            <span class="spinner-border spinner-border-sm me-2" role="status" aria-hidden="true"></span>
                            Loading rating overview...
                        </div>
                    </div>
                    <hr>
                    <div id="reviewsContainer">
                        <div class="text-center">
                            <span class="spinner-border spinner-border-sm me-2" role="status" aria-hidden="true"></span>
                            Loading reviews...
                        </div>
                    </div>
                    <hr>
                    <h6>Add New Review</h6>
                    <form id="reviewForm">
                        <input type="hidden" id="reviewApartmentId">
                        <div class="mb-3">
                            <label for="reviewRating" class="form-label">Rating <span class="text-danger">*</span></label>
                            <div class="star-rating" id="reviewStarRating">
                                <input type="radio" id="star10" name="rating" value="5">
                                <label for="star10" class="star-label" data-rating="5">
                                    <span class="star-half-left" data-rating="4.5" onclick="selectHalfStar(4.5)"></span>
                                    <span class="star-half-right" data-rating="5" onclick="selectHalfStar(5)"></span>
                                    ‚òÖ
                                </label>
                                <input type="radio" id="star9" name="rating" value="4.5">
                                <input type="radio" id="star8" name="rating" value="4">
                                <label for="star8" class="star-label" data-rating="4">
                                    <span class="star-half-left" data-rating="3.5" onclick="selectHalfStar(3.5)"></span>
                                    <span class="star-half-right" data-rating="4" onclick="selectHalfStar(4)"></span>
                                    ‚òÖ
                                </label>
                                <input type="radio" id="star7" name="rating" value="3.5">
                                <input type="radio" id="star6" name="rating" value="3">
                                <label for="star6" class="star-label" data-rating="3">
                                    <span class="star-half-left" data-rating="2.5" onclick="selectHalfStar(2.5)"></span>
                                    <span class="star-half-right" data-rating="3" onclick="selectHalfStar(3)"></span>
                                    ‚òÖ
                                </label>
                                <input type="radio" id="star5" name="rating" value="2.5">
                                <input type="radio" id="star4" name="rating" value="2">
                                <label for="star4" class="star-label" data-rating="2">
                                    <span class="star-half-left" data-rating="1.5" onclick="selectHalfStar(1.5)"></span>
                                    <span class="star-half-right" data-rating="2" onclick="selectHalfStar(2)"></span>
                                    ‚òÖ
                                </label>
                                <input type="radio" id="star3" name="rating" value="1.5">
                                <input type="radio" id="star2" name="rating" value="1">
                                <label for="star2" class="star-label" data-rating="1">
                                    <span class="star-half-left" data-rating="0.5" onclick="selectHalfStar(0.5)"></span>
                                    <span class="star-half-right" data-rating="1" onclick="selectHalfStar(1)"></span>
                                    ‚òÖ
                                </label>
                                <input type="radio" id="star1" name="rating" value="0.5">
                                <input type="hidden" id="selectedRating" name="selectedRating" value="" required>
                            </div>
                            <small class="form-text text-muted">Click a star to rate (0.5-5 stars, click left half for half-star)</small>
                        </div>
                        <div class="mb-3">
                            <label for="reviewComment" class="form-label">Comment</label>
                            <textarea class="form-control" id="reviewComment" rows="4" placeholder="Share your thoughts about this apartment..."></textarea>
                        </div>
                        <button type="button" class="btn btn-primary" onclick="saveReview()">Submit Review</button>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Export/Import Modal -->
    <div class="modal fade" id="exportModal" tabindex="-1" aria-labelledby="exportModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="exportModalLabel">Export Data</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="mb-3">
                        <button type="button" class="btn btn-sm btn-secondary" onclick="copyToClipboard('exportTextarea')">üìã Copy to Clipboard</button>
                    </div>
                    <div class="mb-3">
                        <label for="exportTextarea" class="form-label">Exported Data:</label>
                        <textarea class="form-control" id="exportTextarea" rows="15" readonly></textarea>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Import Modal -->
    <div class="modal fade" id="importModal" tabindex="-1" aria-labelledby="importModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="importModalLabel">Import Apartments</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="alert alert-warning">
                        <strong>Warning:</strong> Importing will create new apartments or update existing ones based on IDs. Make sure to export your current data first!
                    </div>
                    <div class="mb-3">
                        <label for="importTextarea" class="form-label">Paste JSON Data:</label>
                        <textarea class="form-control" id="importTextarea" rows="10" placeholder='[{"id": 1, "location": "...", ...}]'></textarea>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary" onclick="importApartments()">Import</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Import Timers Modal -->
    <div class="modal fade" id="importTimersModal" tabindex="-1" aria-labelledby="importTimersModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="importTimersModalLabel">Import Timers</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="alert alert-warning">
                        <strong>Warning:</strong> This will update due_date and clean_time for apartments. Make sure to export your current timers first!
                    </div>
                    <div class="mb-3">
                        <label for="importTimersTextarea" class="form-label">Paste JSON Data:</label>
                        <textarea class="form-control" id="importTimersTextarea" rows="10" placeholder='[{"apartment_id": 1, "due_date": "...", "clean_time": "..."}]'></textarea>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary" onclick="importTimers()">Import</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Import Reviews Modal -->
    <div class="modal fade" id="importReviewsModal" tabindex="-1" aria-labelledby="importReviewsModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="importReviewsModalLabel">Import Reviews</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="alert alert-warning">
                        <strong>Warning:</strong> This will add or update reviews for apartments. Reviews with existing IDs will be updated, new reviews will be added. Make sure to export your current reviews first!
                    </div>
                    <div class="mb-3">
                        <label for="importReviewsTextarea" class="form-label">Paste JSON Data:</label>
                        <textarea class="form-control" id="importReviewsTextarea" rows="10" placeholder='[{"id": 1234567890, "apartment_id": 1, "rating": 5, "comment": "...", "created_at": "...", "updated_at": "..."}]'></textarea>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary" onclick="importReviews()">Import</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Import All Data Modal -->
    <div class="modal fade" id="importAllModal" tabindex="-1" aria-labelledby="importAllModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="importAllModalLabel">Import All Data</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="alert alert-danger">
                        <strong>‚ö†Ô∏è Warning:</strong> This will import apartments, timers, and reviews all at once. This operation will:
                        <ul class="mb-0 mt-2">
                            <li>Create new apartments or update existing ones based on IDs</li>
                            <li>Update due_date and clean_time for apartments</li>
                            <li>Add or update reviews for apartments</li>
                        </ul>
                        <strong class="mt-2 d-block">Make sure to export your current data first!</strong>
                    </div>
                    <div class="mb-3">
                        <label for="importAllTextarea" class="form-label">Paste JSON Data:</label>
                        <textarea class="form-control" id="importAllTextarea" rows="15" placeholder='{"apartments": [...], "timers": [...], "reviews": [...]}'></textarea>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary" onclick="importAll()">Import All</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="bg-light py-3">
        <div class="container text-center">
            <div id="version-display" class="mt-2" style="font-size: 0.875rem; color: #6c757d;">
                <!-- Version will be inserted here by site-config.js -->
            </div>
        </div>
    </footer>

    <!-- Bootstrap JS -->
    <script src="js/bootstrap.bundle.min.js"></script>
    <!-- Theme JS -->
    <script src="js/theme.js"></script>
    <!-- Site Configuration & Version Manager (load in order) -->
    <script src="js/config/config-data.js"></script>
    <script src="js/config/site-config.js"></script>
    <script src="js/config/version-manager.js"></script>
    <script src="js/site-config.js"></script>
    <!-- Navbar Manager -->
    <script src="js/navbar.js"></script>
    <!-- Number Formatter -->
    <script src="js/number-formatter.js"></script>
    <!-- Debug Manager -->
    <script src="js/debug-manager.js"></script>
    <!-- Apartment Management JS -->
    <script src="js/pages/apartment/apartment-core.js"></script>
    <script src="js/pages/apartment/apartment-ui.js"></script>
    <script src="js/pages/apartment/apartment-modals.js"></script>
    <script src="js/pages/apartment/apartment-init.js"></script>
    <!-- Inline script removed - using modular scripts above -->
</body>
</html>

